:noremap j jjjjj
:noremap k kkkkk
:colorscheme darkness
set gui=nomenu,nobookmarks
set titlestring=""

javascript <<EOF
(function () {
    function tabExists(name) {
        var tabList = tabs.get();
        for (var i = 0; i < tabList.length; i++) {
            if (tabList[i][1].indexOf(name) > -1
                || tabList[i][2].indexOf(name) > -1)
                return true;  
        }
        return false;
    }

    function isNewWindow() {
        var tabList = tabs.get();
        return (tabList.length == 1 
            && tabList[0][1].indexOf("Firefox Start Page") > -1);
    }

    //TODO
    //function isNewTab() {
    //    var current = tabs.get(tabs.CURRENT_TAB);
    //    return (current[0][1].indexOf("New Tab") > -1);
    //}

    commands.addUserCommand(
        ['it'],
        'Italian word multi-search',
        function (args) {
            var word = args.string;

            if (tabExists("grandidizionari")) {
                tabs.switchTo("grandidizionari", false);
                liberator.execute(":open dizionario " + word);
            } else {
                if (isNewWindow()) // || isNewTab()
                    liberator.execute(":open dizionario " + word);
                else
                    liberator.execute(":tabopen dizionario " + word);
            }

            if (tabExists("wikipedia")) {
                tabs.switchTo("wikipedia", false);
                liberator.execute(":open it_wiki " + word);
            } else {
                liberator.execute(":tabopen it_wiki " + word);
            }

            if (tabExists("Cerca con Google")) {
                tabs.switchTo("Cerca con Google", false);
                liberator.execute(":open it_google " + word);
            } else {
                liberator.execute(":tabopen it_google " + word);
            }

            if (tabExists("Google Search")) {
                tabs.switchTo("Google Search", false);
                liberator.execute(":open image " + word);
            } else {
                liberator.execute(":tabopen image " + word);
            }

            if (tabExists("forvo")) {
                tabs.switchTo("forvo", false);
                liberator.execute(":open forvo " + word);
            } else {
                liberator.execute(":tabopen forvo " + word);
            }

            if (tabExists("wiktionary")) {
                tabs.switchTo("wiktionary", false);
                liberator.execute(":open wiktionary " + word);
            } else {
                liberator.execute(":tabopen wiktionary " + word);
            }

            if (tabExists("WordReference")) {
                tabs.switchTo("WordReference", false);
                liberator.execute(":open it_wr " + word);
            } else {
                liberator.execute(":tabopen it_wr " + word);
            }
        }
    );
})();
EOF

javascript <<EOF
(function () {
    function tabExists(name) {
        var tabList = tabs.get();
        for (var i = 0; i < tabList.length; i++) {
            if (tabList[i][1].indexOf(name) > -1
                || tabList[i][2].indexOf(name) > -1)
                return true;  
        }
        return false;
    }

    function isNewWindow() {
        var tabList = tabs.get();
        return (tabList.length == 1 
            && tabList[0][1].indexOf("Firefox Start Page") > -1);
    }

    //TODO
    //function isNewTab() {
    //    var current = tabs.get(tabs.CURRENT_TAB);
    //    return (current[0][1].indexOf("New Tab") > -1);
    //}

    commands.addUserCommand(
        ['jp'],
        'Japanese word multi-search',
        function (args) {
            var word = args.string;

            if (tabExists("wikipedia")) {
                tabs.switchTo("wikipedia", false);
                liberator.execute(":open jp_wiki " + word);
            } else {
                if (isNewWindow()) // || isNewTab()
                    liberator.execute(":open jp_wiki " + word);
                else
                    liberator.execute(":tabopen jp_wiki " + word);
            }

            if (tabExists("Google Search")) {
                tabs.switchTo("Google Search", false);
                liberator.execute(":open google " + word);
            } else {
                liberator.execute(":tabopen google " + word);
            }

            if (tabExists("Google 検索")) {
                tabs.switchTo("Google 検索", false);
                liberator.execute(":open jp_google " + word);
            } else {
                liberator.execute(":tabopen jp_google " + word);
            }

            if (tabExists("forvo")) {
                tabs.switchTo("forvo", false);
                liberator.execute(":open forvo " + word);
            } else {
                liberator.execute(":tabopen forvo " + word);
            }

            //if (tabExists("Kanji")) {
            //    tabs.switchTo("Kanji", false);
            //    liberator.execute(":open saiga-jp " + word);
            //} else {
            //    liberator.execute(":tabopen saiga-jp " + word);
            //}

            //if (tabExists("wiktionary")) {
            //    tabs.switchTo("wiktionary", false);
            //    liberator.execute(":open wiktionary " + word);
            //} else {
            //    liberator.execute(":tabopen wiktionary " + word);
            //}

            if (tabExists("jisho")) {
                tabs.switchTo("jisho", false);
                liberator.execute(":open jisho " + word);
            } else {
                liberator.execute(":tabopen jisho " + word);
            }
        }
    );
})();
EOF
